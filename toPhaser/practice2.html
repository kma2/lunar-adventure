<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
		<title>Phaser - Making your first game, part 9</title>
	<script type="text/javascript" src="phaser.min.js"></script>
		<style type="text/css">
				body {
						margin: 0;
				}
		</style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(window.innerWidth, window.innerHeight, Phaser.AUTO, 'phaser-example', { preload: preload, create: create, update:update });

function preload() {
	game.load.image('car', 'rocket.png');
	game.load.image('planet', 'planet2.png');
}

function create() {

  
	game.physics.startSystem(Phaser.Physics.P2JS);
	// game.physics.p2.gravity.y = 40;

	cursors = game.input.keyboard.createCursorKeys();

	var shipCollisionGroup = game.physics.p2.createCollisionGroup();
  var starCollisionGroup = game.physics.p2.createCollisionGroup();


	var stars = game.add.group();
  stars.enableBody = true;
  stars.physicsBodyType = Phaser.Physics.P2JS;

	var graphics = game.add.graphics(0, 0);

    // graphics.lineStyle(2, 0xffd900, 1);

  graphics.beginFill(0xFF0000, 1);
  graphics.drawCircle(300, 300, 100);

  star = game.add.sprite(300, 300, graphics.generateTexture());



  // var star = stars.create(game.world.width/4, game.world.height/4, 'planet');
  // star.scale.setTo(0.1, 0.1)
	game.physics.p2.enable(star);
  star.body.setCollisionGroup(starCollisionGroup);
  star.body.collides([starCollisionGroup, shipCollisionGroup]);
  graphics.destroy()


	//  ship
	ship = game.add.sprite(game.world.width/2, game.world.height/5, 'car');
	ship.scale.setTo(0.05, 0.05)

	game.physics.p2.enable(ship);
	ship.body.collideWorldBounds = true;
	ship.body.setCollisionGroup(shipCollisionGroup);

	// ship.setCollisionGroup()
  ship.body.collides(starCollisionGroup, hitStar, this);

};


function hitStar(body1, body2) {

    //  body1 is the space ship (as it's the body that owns the callback)
    //  body2 is the body it impacted with, in this case our panda
    //  As body2 is a Phaser.Physics.P2.Body object, you access its own (the sprite) via the sprite property:
    body2.sprite.alpha -= 0.1;

}



function update() {
		// left key, rotate ship
		if (cursors.left.isDown) { ship.body.rotateLeft(100); }
		// right key, rotate ship
		else if (cursors.right.isDown){ ship.body.rotateRight(100); }
		// stop rotating if key is not pressed
		else { ship.body.setZeroRotation(); }
		// up key, accelerate
		if (cursors.up.isDown){ ship.body.thrust(200); }
		// down key, reverse accelerate
		else if (cursors.down.isDown){ ship.body.reverse(200); }
};

</script>

</body>
</html>