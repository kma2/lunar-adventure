<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
		<title>Phaser - Making your first game, part 9</title>
	<script type="text/javascript" src="phaser.min.js"></script>
		<style type="text/css">
				body {
						margin: 0;
				}
		</style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(800, 600, Phaser.AUTO, 'phaser-example', { preload: preload, create: create, update:update });

function preload() {
		game.load.image('car', 'rocket.png');
		// game.load.image('tinycar', 'tinycar.png');
}

function create() {
		game.physics.startSystem(Phaser.Physics.P2JS);
		game.physics.p2.gravity.y = 50;

		cursors = game.input.keyboard.createCursorKeys();
		ship = game.add.sprite(32, game.world.height - 150, 'car');
		ship.scale.setTo(0.05, 0.05)
		// console.log(ship.b)
		game.physics.p2.enable(ship);
		
};

function update() {
		// bullets.forEachAlive(moveBullets,this);  //make bullets accelerate to ship

		if (cursors.left.isDown) {
			console.log(ship.body.world.pxm(-100))
			// function (a){this.data.angularVelocity=this.world.pxm(-a)}
			ship.body.angle -= 5
		}   //ship movement
		else if (cursors.right.isDown){
			ship.body.rotateRight(100);
		}
		else {
			ship.body.setZeroRotation();
			// if (ship.body.angle < 0) {
			// 	if (ship.body.angle > -5) ship.body.angle = 0;
			// 	else ship.body.angle += 5
			// } else if(ship.body.angle > 0) {
			// 	if (ship.body.angle < 5) ship.body.angle = 0;
			// 	else ship.body.angle -= 5
			// }
		}
		// console.log(ship.body)
		if (cursors.up.isDown){ship.body.thrust(200);}
		else if (cursors.down.isDown){ship.body.reverse(200);}
};


// function moveBullets (bullet) { 
//      accelerateToObject(bullet,ship,30);  //start accelerateToObject on every bullet
// }

// function accelerateToObject(obj1, obj2, speed) {
//     if (typeof speed === 'undefined') { speed = 60; }
//     var angle = Math.atan2(obj2.y - obj1.y, obj2.x - obj1.x);
//     obj1.body.rotation = angle + game.math.degToRad(90);  // correct angle of angry bullets (depends on the sprite used)
//     obj1.body.force.x = Math.cos(angle) * speed;    // accelerateToObject 
//     obj1.body.force.y = Math.sin(angle) * speed;
// }

</script>

</body>
</html>